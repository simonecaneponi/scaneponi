'use strict';
const IpRangeCheck = require('ip-range-check');

const DefaultMetrics = require('../metric/default');

module.exports.ipIsWhiteListed = function (/*ip_address*/) {

    return '';
};

module.exports.whitelistTheseIPs = function (rangeList) {

    module.exports.ipIsWhiteListed = function (ip_address) {

        for (let i = 0; i < rangeList.length; ++i) {
            if (IpRangeCheck(ip_address, rangeList[i])) {
                return rangeList[i];
            }
        }
        return '';
    };
};

let list = [];
module.exports.whitelistThesePaths = function (pathList) {

    list = pathList;
};

module.exports.pathIsWhiteListed = function (path) {

    if (!path || list.length === 0) {
        return '';
    }

    for (let i = 0; i < list.length; ++i) {
        if (path.indexOf(list[i]) === 0) {
            return list[i];
        }
    }
    return '';
};

DefaultMetrics.enableWhitelisted();
