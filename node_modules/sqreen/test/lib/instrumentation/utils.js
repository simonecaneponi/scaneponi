/**
 * Copyright (c) 2016 Sqreen. All Rights Reserved.
 * Please refer to our terms for more information: https://www.sqreen.io/terms.html
 */
'use strict';
const Code = require('code');
const Lab = require('lab');
const lab = exports.lab = Lab.script();

const describe = lab.describe;
const it = lab.it;
const expect = Code.expect;

const Utils = require('../../../lib/instrumentation/utils');

describe('InstrumentationUtils', () => {

    describe.skip('pathIsWhiteListed', () => {

        it('should find that the path is whitelisted or not', { plan: 6 }, (done) => {

            const list = ['/admin', '/me/'];

            expect(Utils.pathIsWhiteListed('/administration/', list)).to.equal('/admin');
            expect(Utils.pathIsWhiteListed('/admin/istration/', list)).to.equal('/admin');
            expect(Utils.pathIsWhiteListed('/me/you', list)).to.equal('/me/');
            expect(Utils.pathIsWhiteListed('/user', list)).to.equal('');
            expect(Utils.pathIsWhiteListed('', list)).to.equal('');
            expect(Utils.pathIsWhiteListed('/user/admin/me', list)).to.equal('');
            done();
        });
    });

    describe('getListSession', () => {

        it('should find the original session', { plan: 2 }, (done) => {

            expect(Utils.getListSession([{}, {}, { originalSession: { a: 1 } }, { originalSession: { a: 1 } }])).to.equal({ a: 1 });
            expect(Utils.getListSession([{}, {}])).to.not.exist();
            done();
        });
    });
});
