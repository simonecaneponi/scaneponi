/**
 * Copyright (c) 2016 Sqreen. All Rights Reserved.
 * Please refer to our terms for more information: https://www.sqreen.io/terms.html
 */
'use strict';
const Code = require('code');
const Lab = require('lab');
const lab = exports.lab = Lab.script();
const beforeEach = lab.beforeEach;

const describe = lab.describe;
const it = lab.it;
const expect = Code.expect;

const Metric = require('../../../lib/metric');
const Default = require('../../../lib/metric/default');

describe('Metric', () => {

    beforeEach((done) => {

        Metric._clearAllMetrics();
        done();
    });

    describe('Default', () => {

        it('should start the default metric', { plan: 1 }, (done) => {

            Default.enableCallCount();
            const metric = Metric.getMetricByName('sqreen_call_counts');

            expect(metric.period).to.equal(60000);
            done();
        });

        it('should start the default metric with curtom time', { plan: 1 }, (done) => {

            Default.enableCallCount();
            Default.enableCallCount(70);
            const metric = Metric.getMetricByName('sqreen_call_counts');

            expect(metric.period).to.equal(70000);
            done();
        });
    });
});
