/**
 * Copyright (c) 2016 Sqreen. All Rights Reserved.
 * Please refer to our terms for more information: https://www.sqreen.io/terms.html
 */
'use strict';
const Code = require('code');
const Lab = require('lab');
const lab = exports.lab = Lab.script();

const describe = lab.describe;
const it = lab.it;
const expect = Code.expect;
const NotFound = require('../../../../lib/rules/rules-callback/notFound');

describe('notFound', () => {

    describe('pre', () => {

        it('should report a 404', { plan: 4 }, (done) => {


            const pre = NotFound.getCbs().pre;
            expect(pre({ '0': 403 })).to.not.exist();
            expect(pre({ '0': 403 }, null, null, null, { req: {} })).to.not.exist();
            expect(pre({ '0': 404 }, null, null, null, { req: {} })).to.equal({ record: { host: undefined, path: undefined, ua: undefined, verb: undefined } });
            expect(pre({ '0': 404 }, null, null, null, { req: { headers : { host: 'a' } } })).to.equal({ record: { host: 'a', path: undefined, ua: undefined, verb: undefined } });
            done();
        });
    });
});
