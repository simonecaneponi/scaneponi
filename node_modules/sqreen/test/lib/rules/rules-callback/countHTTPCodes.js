/**
 * Copyright (c) 2016 Sqreen. All Rights Reserved.
 * Please refer to our terms for more information: https://www.sqreen.io/terms.html
 */
'use strict';
const Code = require('code');
const Lab = require('lab');
const lab = exports.lab = Lab.script();

const describe = lab.describe;
const it = lab.it;
const expect = Code.expect;

const Pre = require('../../../../lib/rules/rules-callback').CountHTTPCodes().pre;

describe('CountHTTPCodes', () => {

    it('should report it', { plan: 4 }, (done) => {

        const result = Pre(null, null, null, { statusCode: 200 });
        expect(result.observations[0][0]).to.equal('http_code');
        expect(result.observations[0][1]).to.equal(200);
        expect(result.observations[0][2]).to.equal(1);

        const result2 = Pre(null, null, null, {});
        expect(result2).to.not.exist();
        done();
    });
});
