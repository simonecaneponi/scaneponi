/**
 * Copyright (c) 2016 Sqreen. All Rights Reserved.
 * Please refer to our terms for more information: https://www.sqreen.io/terms.html
 */
'use strict';
const Code = require('code');
const Lab = require('lab');
const lab = exports.lab = Lab.script();

const describe = lab.describe;
const it = lab.it;
const expect = Code.expect;

const RegexpRule = require('../../../../lib/rules/rules-callback/regexpRule');

describe('RegexpRule', () => {

    describe('getRegexpMatcher', () => {

        it('should get a regex matcher and use it', { plan: 5 }, (done) => {

            expect(RegexpRule.getRegexpMatcher()).to.not.exist();
            expect(RegexpRule.getRegexpMatcher({})).to.not.exist();

            const matcher = RegexpRule.getRegexpMatcher('a');

            expect(matcher).to.be.a.function();
            expect(matcher('a')).to.be.true();
            expect(matcher('b')).to.be.false();

            done();
        });
    });

    describe('getRegexpMatcherClass', () => {

        it('should get a regex matcher and use it', { plan: 5 }, (done) => {

            const matcher = RegexpRule.getRegexpMatcherObject('a');

            expect(matcher.match).to.be.a.function();
            expect(matcher.match('a')).to.be.true();
            expect(matcher.pattern).to.equal('a');
            expect(matcher.match('b')).to.be.false();

            const matcher2 = RegexpRule.getRegexpMatcherObject(10);
            expect(matcher2.match('a')).to.be.false();


            done();
        });
    });
});
